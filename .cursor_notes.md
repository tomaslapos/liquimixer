# LiquiMixer - PoznÃ¡mky pro AI asistenta

## ğŸ“‘ OBSAH (RYCHLÃ NAVIGACE)

| Sekce | Popis | DÅ¯leÅ¾itost |
|-------|-------|------------|
| [âš ï¸ KRITICKÃ PRAVIDLA](#ï¸-kritickÃ¡-pravidla---pÅ™eÄti-pÅ™ed-kaÅ¾dou-pracÃ­) | PowerShell, pÅ™eklady, Git, checklist | ğŸ”´ POVINNÃ‰ |
| [ğŸ“ STRUKTURA PROJEKTU](#-struktura-projektu) | Soubory, organizace app.js, pÅ™eklady | ğŸŸ¡ DÅ¯leÅ¾itÃ© |
| [ğŸ”§ KLÃÄŒOVÃ‰ FUNKCE](#-klÃ­ÄovÃ©-funkce) | Kalkulace, recepty, pÅ™ipomÃ­nky, i18n | ğŸŸ¡ DÅ¯leÅ¾itÃ© |
| [ğŸ“„ iDoklad API](#-idoklad-api-integrace) | DPH, mÄ›ny, VatRateType, faktury | ğŸŸ¢ Reference |
| [ğŸŒ JAZYK vs GEOLOKACE](#-jazyk-vs-geolokace---dvÄ›-nezÃ¡vislÃ©-funkce) | Locale vs Country, DPH logika | ğŸŸ¢ Reference |
| [ğŸ”§ SUPABASE CLI](#-supabase-cli) | PÅ™Ã­kazy, migrace, deploy | ğŸŸ¢ Reference |
| [ğŸ“‹ AKTUÃLNÃ ÃšKOLY](#-aktuÃ¡lnÃ­-Ãºkoly) | Co je k Å™eÅ¡enÃ­ | ğŸŸ¡ DÅ¯leÅ¾itÃ© |
| [ğŸŒŸ PLÃNOVANÃ‰ FUNKCE](#-plÃ¡novanÃ©-funkce) | DatabÃ¡ze pÅ™Ã­chutÃ­, produkty | ğŸŸ¢ Info |

---

## âš ï¸ KRITICKÃ PRAVIDLA - PÅ˜EÄŒTI PÅ˜ED KAÅ½DOU PRACÃ!

### 1. NIKDY NEPOUÅ TÄšT POWERSHELL PRO EDITACI SOUBORÅ®!

**ProÄ:**
- PowerShell na Windows mÃ¡ fatÃ¡lnÃ­ problÃ©my s UTF-8 kÃ³dovÃ¡nÃ­m
- Cesta `C:\Users\TomÃ¡Å¡Lapos` se rozpadne na `C:\Users\Tomï¿½ï¿½ï¿½Lapos`
- ÄŒeskÃ© znaky se zniÄÃ­: `Å½Ã¡dnÃ¡` â†’ `â”¼Å»â”œÃ­dnâ”œÃ­`, `pÅ™Ã­chuÅ¥` â†’ `pâ”¼Ã–â”œÅŸchuâ”¼Ä…`
- Emoji se rozpadnou: `ğŸ‘¤` â†’ `Â­ÄÄ¹Ä„`, `â˜…` â†’ `Ã”Å›Å¯`, `ğŸ—‘ï¸` â†’ `Ã”Å¥Ä½`

**Jak sprÃ¡vnÄ›:**
- Pro editaci souborÅ¯: VÃHRADNÄš nÃ¡stroje Cursor (`search_replace`, `write`, `read_file`)
- Pro Git operace: `cmd /c "git add -A && git commit -m 'message' && git push"`
- KrÃ¡tkÃ¡ cesta uÅ¾ivatele: `C:\Users\TOMLAP~1\Liquimixer`

**ZAKÃZANÃ‰ pÅ™Ã­kazy:**
```
âŒ Set-Content, Add-Content, Out-File
âŒ [System.IO.File]::WriteAllText()
âŒ (Get-Content file) -replace
âŒ jakÃ½koliv PowerShell pÅ™Ã­kaz co zapisuje do souboru
```

### 2. PÅ˜EKLADY NEDÄšLAT SKRIPTEM!

**ProÄ:**
- AutomatickÃ© skripty (generate-locales.js, complete-translations.js) NEFUNGUJÃ
- GenerujÃ­ neplatnÃ½ JSON nebo chybnÃ© pÅ™eklady

**Jak sprÃ¡vnÄ› pÅ™idÃ¡vat pÅ™eklady:**
1. **ReferenÄnÃ­ soubor:** `locales/cs.json` - VÅ½DY porovnÃ¡vat s tÃ­mto
2. OtevÅ™Ã­t JEDEN jazykovÃ½ soubor, pÅ™idat klÃ­Ä, opakovat pro dalÅ¡Ã­ jazyky POSTUPNÄš
3. Po kaÅ¾dÃ© ÃºpravÄ› ovÄ›Å™it validitu JSON

**31 podporovanÃ½ch jazykÅ¯:**
cs, en, de, fr, es, it, pl, ru, pt, nl, ja, ko, zh-CN, zh-TW, ar-SA, 
sv, da, fi, no, hr, sr, bg, ro, lt, lv, et, hu, el, uk, sk, tr

### 3. NAHRÃVÃNÃ NA GITHUB

**PRAVIDLO:** NahrÃ¡vat POUZE po testovÃ¡nÃ­ a schvÃ¡lenÃ­ uÅ¾ivatelem!

**Git pÅ™Ã­kazy (pÅ™es cmd):**
```bash
cmd /c "cd C:\Users\TOMLAP~1\Liquimixer && git status"
cmd /c "cd C:\Users\TOMLAP~1\Liquimixer && git add -A"
cmd /c "cd C:\Users\TOMLAP~1\Liquimixer && git commit -m popis-zmeny"
cmd /c "cd C:\Users\TOMLAP~1\Liquimixer && git push origin main"
```

**POZOR:** Branch je `main`, NE `master`!
**POZOR:** Commit message BEZ mezer a speciÃ¡lnÃ­ch znakÅ¯ (napÅ™. `fix-idoklad-jwt`)

### 4. PÅ˜ED KAÅ½DOU ZMÄšNOU

**âœ… CHECKLIST PÅ˜ED ZMÄšNOU V APP.JS:**
```
[ ] 1. Grep na nÃ¡zev funkce - existuje uÅ¾ jinde v souboru?
[ ] 2. PÅ™eÄÃ­st 50 Å™Ã¡dkÅ¯ PÅ˜ED a PO mÃ­stÄ› zmÄ›ny (kontext)
[ ] 3. Zkontrolovat, Å¾e nemÄ›nÃ­m funkÄnÃ­ kÃ³d (jen to potÅ™ebnÃ©)
[ ] 4. ZmÄ›na je MINIMÃLNÃ - jen to co je opravdu nutnÃ©
[ ] 5. Po zmÄ›nÄ›: ReadLints pro kontrolu syntaktickÃ½ch chyb
[ ] 6. NepouÅ¾Ã­vat PowerShell pro editaci!
```

### 5. ğŸš« KRITICKÃ‰ FUNKCE - NIKDY NEMÄšNIT BEZ KONZULTACE

| Funkce | Soubor | ProÄ je kritickÃ¡ |
|--------|--------|------------------|
| `calculateMix()` | app.js | HlavnÃ­ vÃ½poÄet Liquid |
| `calculateProMix()` | app.js | HlavnÃ­ vÃ½poÄet Liquid PRO |
| `calculateShishaMix()` | app.js | HlavnÃ­ vÃ½poÄet Shisha |
| `displayResults()` | app.js | ZobrazenÃ­ vÃ½sledkÅ¯ VÅ ECH formulÃ¡Å™Å¯ |
| `displayRecipeDetail()` | app.js | ZobrazenÃ­ detailu receptu |
| `saveRecipe()` | app.js | UklÃ¡dÃ¡nÃ­ do DB, validace |
| `getIngredientName()` | app.js | PÅ™eklad ingrediencÃ­ |
| `saveUserRecipe()` | database.js | Supabase uklÃ¡dÃ¡nÃ­ receptu |
| `getPublicRecipes()` | database.js | VeÅ™ejnÃ¡ databÃ¡ze receptÅ¯ |

### 6. âœ… FUNKCE KTERÃ‰ FUNGUJÃ - NETESTOVAT ZNOVU

- [x] Liquid kalkulace (`calculateMix`)
- [x] Liquid PRO multi-flavor (`calculateProMix`)
- [x] Shisha separÃ¡tnÃ­ VG/PG (`calculateShishaMix`)
- [x] HodnocenÃ­ receptÅ¯ (`submitRating`)
- [x] Sklad produktÅ¯ - tlaÄÃ­tka +/- (`updateProductStockUI`)
- [x] PÅ™ipomÃ­nky zrÃ¡nÃ­ (`loadRecipeReminders`)
- [x] Navigace mezi formulÃ¡Å™i (`goBackToCalculator`)

### 7. ZÃLOHOVÃNÃ

```bash
cmd /c "robocopy C:\Users\TOMLAP~1\Liquimixer C:\Users\TOMLAP~1\Liquimixer_backup_DATUM /E /XD node_modules .git"
```

---

## ğŸ“ STRUKTURA PROJEKTU

### HlavnÃ­ soubory

| Soubor | Velikost | Popis |
|--------|----------|-------|
| `index.html` | ~123KB | HlavnÃ­ HTML, vÅ¡echny modÃ¡ly, struktura UI |
| `app.js` | ~230KB, ~6000 Å™Ã¡dkÅ¯ | VeÅ¡kerÃ¡ aplikaÄnÃ­ logika |
| `styles.css` | ~107KB | VeÅ¡kerÃ© CSS styly, animace |
| `i18n.js` | ~19KB | Internacionalizace, sprÃ¡va jazykÅ¯ |
| `database.js` | ~36KB | Supabase operace (CRUD) |
| `subscription.js` | ~21KB | PÅ™edplatnÃ©, platby, billing |
| `fcm.js` | ~8KB | Firebase Cloud Messaging |

### Jak je app.js organizovÃ¡n (~6000 Å™Ã¡dkÅ¯):

```
Å˜Ã¡dky 1-50:      BezpeÄnostnÃ­ funkce (escapeHtml, sanitizeUrl)
Å˜Ã¡dky 50-200:    flavorDatabase - typy pÅ™Ã­chutÃ­ a steeping Äasy
Å˜Ã¡dky 200-500:   Inicializace, autentizace (Clerk)
Å˜Ã¡dky 500-1000:  UI funkce (showPage, navigace, modÃ¡ly)
Å˜Ã¡dky 1000-1500: UklÃ¡dÃ¡nÃ­ receptÅ¯, produkty
Å˜Ã¡dky 1500-2000: Editace receptÅ¯, zobrazenÃ­ detailu
Å˜Ã¡dky 2000-3000: VÃ½poÄetnÃ­ funkce (calculateMix, calculateProMix)
Å˜Ã¡dky 3000-4000: Liquid PRO multi-flavor logika
Å˜Ã¡dky 4000-5000: VÃ½sledky, tabulky, zobrazenÃ­
Å˜Ã¡dky 5000-5500: PÅ™ipomÃ­nky zrÃ¡nÃ­ (reminders)
Å˜Ã¡dky 5500-6000: Kontakt, menu, pomocnÃ© funkce
Å˜Ã¡dky 6000+:     window.* exporty pro globÃ¡lnÃ­ pÅ™Ã­stup
```

### PÅ™eklady - DÅ®LEÅ½ITÃ‰

**UmÃ­stÄ›nÃ­:** `locales/` sloÅ¾ka

**ReferenÄnÃ­ soubor:** `locales/cs.json` - VÅ½DY porovnÃ¡vat s tÃ­mto!

**PouÅ¾itÃ­ v HTML:**
```html
<span data-i18n="section.key">Fallback text</span>
<input data-i18n-placeholder="section.key" placeholder="Fallback">
```

**PouÅ¾itÃ­ v JS:**
```javascript
const text = t('section.key', 'Fallback text');
// Po dynamickÃ©m renderovÃ¡nÃ­:
window.i18n.applyTranslations();
```

### Supabase Backend

**Edge funkce:** `supabase/functions/`

| Funkce | ÃšÄel | verify_jwt |
|--------|------|------------|
| `billing/` | Fakturace | true |
| `contact/` | KontaktnÃ­ formulÃ¡Å™ | true |
| `geolocation/` | Geolokace uÅ¾ivatele | true |
| `gpwebpay/` | PlatebnÃ­ brÃ¡na callback | **false** |
| `idoklad/` | iDoklad integrace | **false** |
| `invoice/` | GenerovÃ¡nÃ­ faktur | **false** |
| `subscription/` | PÅ™edplatnÃ© | true |
| `reminder-notify/` | Notifikace (CRON) | true |
| `user-cleanup/` | MazÃ¡nÃ­ ÃºÄtÅ¯ (CRON) | true |

**DatabÃ¡zovÃ© tabulky:**

| Tabulka | ÃšÄel |
|---------|------|
| `recipes` | UloÅ¾enÃ© recepty (id, clerk_id, name, recipe_data, is_public) |
| `products` | OblÃ­benÃ© produkty |
| `reminders` | PÅ™ipomÃ­nky zrÃ¡nÃ­ |
| `subscriptions` | PÅ™edplatnÃ© (status, expires_at, user_country) |
| `invoices` | Faktury |
| `payments` | Platby |
| `users` | UÅ¾ivatelÃ© |
| `recipe_ratings` | HodnocenÃ­ receptÅ¯ |

---

## ğŸ”§ KLÃÄŒOVÃ‰ FUNKCE

### Kalkulace e-liquidu

```javascript
calculateMix()      // ZÃ¡kladnÃ­ kalkulÃ¡tor (jedna pÅ™Ã­chuÅ¥)
calculateShakeVape() // Shake & Vape (bez nikotinu)
calculateProMix()   // Liquid PRO (vÃ­ce pÅ™Ã­chutÃ­)
calculateShishaMix() // Shisha kalkulÃ¡tor
```

### ZobrazenÃ­ vÃ½sledkÅ¯

```javascript
displayResults(data, extraData)
// - data: { vg, pg, nic, flavor, total, drops, ... }
// - extraData: { formType, flavorType, flavors }
// - UklÃ¡dÃ¡ do window.currentRecipeData
```

### Recepty

```javascript
showSaveRecipeModal()     // Modal pro NOVÃ recept
showEditRecipeForm()      // Modal pro ÃšPRAVU
saveRecipe()              // UloÅ¾it do Supabase
viewRecipeDetail(recipeId) // Zobrazit detail
displayRecipeDetail()     // Renderovat HTML
```

### PÅ™ipomÃ­nky zrÃ¡nÃ­

```javascript
showAddReminderModal(recipeId)  // NovÃ¡ pÅ™ipomÃ­nka
loadRecipeReminders(recipeId)   // NaÄÃ­st pÅ™ipomÃ­nky
renderReminderItem(reminder)    // Renderovat poloÅ¾ku
```

### i18n systÃ©m

```javascript
t(key, fallback)                    // ZÃ­skat pÅ™eklad
window.i18n.applyTranslations()     // Aplikovat na DOM
window.i18n.setLocale(localeCode)   // ZmÄ›nit jazyk

// Event pÅ™i zmÄ›nÄ› jazyka
window.addEventListener('localeChanged', () => {
    refreshResultsTable();
    refreshRecipeDetail();
});
```

### GlobÃ¡lnÃ­ promÄ›nnÃ©

```javascript
window.currentRecipeData     // AktuÃ¡lnÃ­ vypoÄÃ­tanÃ½ recept
window.currentViewingRecipe  // AktuÃ¡lnÄ› zobrazenÃ½ uloÅ¾enÃ½ recept
window.i18n                  // i18n objekt
window.LiquiMixerDB          // DatabÃ¡zovÃ© operace
window.Clerk                 // Autentizace
```

---

## ğŸŒ JAZYK vs. GEOLOKACE - DVÄš NEZÃVISLÃ‰ FUNKCE!

| Funkce | ÃšÄel | Jak se urÄuje | Kde se pouÅ¾Ã­vÃ¡ |
|--------|------|---------------|----------------|
| **Jazyk (locale)** | Komunikace s uÅ¾ivatelem | ProhlÃ­Å¾eÄ nebo volba uÅ¾ivatele | UI, emaily |
| **Geolokace (country)** | MÃ­sto plnÄ›nÃ­ pro DPH | IP adresa uÅ¾ivatele | Cena, mÄ›na, DPH, iDoklad |

### DPH logika

| ZemÄ› | DPH | iDoklad kontakt | Cena |
|------|-----|-----------------|------|
| CZ | 21% | CZ | 59 CZK |
| EU zemÄ› | 21% | CZ (OSS reÅ¾im) | 2.40 EUR |
| Mimo EU | 0% | SkuteÄnÃ¡ zemÄ› | 2.90 USD |

---

## ğŸ“„ iDoklad API INTEGRACE

### Autentizace
- OAuth 2.0 Client Credentials flow
- Token URL: `https://identity.idoklad.cz/server/connect/token`
- API URL: `https://api.idoklad.cz/v3`

### KlÃ­ÄovÃ© hodnoty

| Parametr | Hodnota | Popis |
|----------|---------|-------|
| `VatRateType: 0` | Basic | 21% DPH (EU) |
| `VatRateType: 3` | Zero | 0% DPH (mimo EU) |
| `VatRateId: 747` | - | 21% pro CZ |
| `VatRateId: 749` | - | 0% |
| `CountryId: 1` | SK | Slovensko |
| `CountryId: 2` | CZ | ÄŒeskÃ¡ republika |
| `CurrencyId: 1` | CZK | - |
| `CurrencyId: 2` | EUR | - |
| `CurrencyId: 11` | USD | POZOR: ne 3! |
| `PriceType: 0` | - | Cena BEZ DPH |

### SprÃ¡vnÃ½ zpÅ¯sob posÃ­lÃ¡nÃ­ faktury

```typescript
Items: [{
  Name: itemName,
  Amount: 1,
  Unit: 'ks',
  UnitPrice: unitPriceWithoutVat, // 48.76 (59/1.21 pro EU)
  VatRateType: 0, // nebo 3 pro mimo EU
  PriceType: 0, // Cena BEZ DPH
}]

// Pro cizÃ­ mÄ›ny pÅ™idat kurz:
ExchangeRate: 25.0, // Kurz z ÄŒNB
ExchangeRateAmount: 1,
```

### PouÄenÃ­ z Å™eÅ¡enÃ­ problÃ©mÅ¯

1. **NEPOUÅ½ÃVAT VatRate a VatRateType souÄasnÄ›** - zpÅ¯sobuje konflikt
2. **iDoklad bere DPH ze zemÄ› kontaktu** - pro EU nastavit kontakt na CZ
3. **NEAKTUALIZOVAT existujÃ­cÃ­ kontakt** - API to nedÄ›lÃ¡ spolehlivÄ›, radÄ›ji vytvoÅ™it novÃ½
4. **Email subject vÅ¾dy anglicky** - nÄ›kterÃ© SMTP servery majÃ­ problÃ©my s UTF-8

---

## ğŸ”§ SUPABASE CLI

### PÅ™Ã­kazy

```bash
# Verze a pÅ™ihlÃ¡Å¡enÃ­
npx supabase --version
npx supabase projects list

# Deploy edge funkcÃ­
npx supabase functions deploy --project-ref krwdfxnvhnxtkhtkbadi

# KonkrÃ©tnÃ­ funkce
npx supabase functions deploy idoklad --project-ref krwdfxnvhnxtkhtkbadi

# Migrace
npx supabase db push
npx supabase db push --include-all  # Pokud jsou lokÃ¡lnÃ­ migrace pÅ™ed vzdÃ¡lenÃ½mi

# Oprava historie migracÃ­
npx supabase migration repair --status applied 20260204
```

**Project reference:** `krwdfxnvhnxtkhtkbadi`

**POZOR:** Pokud migrace selÅ¾e, spustit SQL pÅ™Ã­mo v Supabase Dashboard SQL Editor

---

## ğŸ”— UÅ½ITEÄŒNÃ‰ ODKAZY

- **Produkce:** https://liquimixer.zeabur.app / https://www.liquimixer.com
- **GitHub:** https://github.com/tomaslapos/liquimixer
- **Supabase:** https://supabase.com/dashboard (projekt Liquimixer)
- **Clerk:** https://dashboard.clerk.com (autentizace)
- **Zeabur:** https://zeabur.com (hosting)

---

## ğŸ“ ZÃLOHY

| Datum | SloÅ¾ka | Obsah |
|-------|--------|-------|
| 2026-01-27 | `backup_2026-01-27/` | TikTok OAuth, rozhodovacÃ­ modal, terms_accepted_at |
| 2026-02-05 | `backup_2026-02-05/` | RannÃ­ - po opravÃ¡ch hodnocenÃ­ a Shisha |
| 2026-02-05 | `backup_2026-02-05-evening/` | VeÄernÃ­ - difficulty level, seed recepty |

---

## Kontakty a secrets

### Supabase Secrets
- `GPWEBPAY_MERCHANT_NUMBER`, `GPWEBPAY_PRIVATE_KEY`, `GPWEBPAY_GPE_PUBLIC_KEY`
- `SMTP_HOST`, `SMTP_PORT`, `SMTP_USER`, `SMTP_PASSWORD`
- `IDOKLAD_CLIENT_ID`, `IDOKLAD_CLIENT_SECRET`
- `CLERK_SECRET_KEY`

---

## ğŸ“‹ AKTUÃLNÃ ÃšKOLY

### Priorita VYSOKÃ

1. **Opravit pÅ™eklady ingredientÅ¯ v detailu receptu**
   - `sweetener` se nepÅ™eklÃ¡dÃ¡ (Med, Melasa, Cukr)
   - `shortfill_base` se nepÅ™eklÃ¡dÃ¡
   - PÅ™Ã­chutÄ› se zobrazujÃ­ s mixem jazykÅ¯
   - **Å˜eÅ¡enÃ­:** Upravit `getIngredientName()` v `app.js`

2. **Seed receptÅ¯ do veÅ™ejnÃ© databÃ¡ze**
   - AktuÃ¡lnÄ› pouze 35 receptÅ¯, cÃ­l 230
   - Skript: `supabase/scripts/fix_public_recipes.sql`

### Priorita STÅ˜EDNÃ

3. **ManuÃ¡l/NÃ¡povÄ›da pro PRO uÅ¾ivatele**
4. **DatabÃ¡ze pÅ™Ã­chutÃ­ od vÃ½robcÅ¯** (viz plÃ¡novanÃ© funkce)

### ÄŒekajÃ­cÃ­ na schvÃ¡lenÃ­

- **Apple Developer Program** - Enrollment ID: 2D2P4U5VJU

---

## ğŸŒŸ IMPLEMENTOVANÃ‰ FUNKCE (2026-02-09)

### âœ… DatabÃ¡ze pÅ™Ã­chutÃ­ - IMPLEMENTOVÃNO

**KompletnÃ­ implementace databÃ¡ze pÅ™Ã­chutÃ­ s nÃ¡sledujÃ­cÃ­mi funkcemi:**

**DatabÃ¡zovÃ© tabulky:**
- `flavor_manufacturers` - vÃ½robci pÅ™Ã­chutÃ­ (CAP, TPA, FA, ALF, ADA...)
- `flavors` - pÅ™Ã­chutÄ› s doporuÄenÃ½m %, steep time, kategoriÃ­
- `flavor_ratings` - hodnocenÃ­ pÅ™Ã­chutÃ­ uÅ¾ivateli
- `recipe_flavors` - vazba recept-pÅ™Ã­chuÅ¥
- RozÅ¡Ã­Å™enÃ­ `favorite_products` o flavor-specifickÃ¡ pole

**Migrace:** `supabase/migrations/20260209_*.sql`

**UI funkce:**
- Menu poloÅ¾ka "DatabÃ¡ze pÅ™Ã­chutÃ­" (pro pÅ™ihlÃ¡Å¡enÃ©)
- Seznam s filtry (typ, vÃ½robce, kategorie, hodnocenÃ­)
- Detail pÅ™Ã­chutÄ› s hodnocenÃ­m
- UloÅ¾enÃ­ do oblÃ­benÃ½ch

**FormulÃ¡Å™ oblÃ­benÃ½ch produktÅ¯:**
- RozÅ¡Ã­Å™enÃ¡ pole pro pÅ™Ã­chutÄ› (typ vape/shisha, vÃ½robce, steep days, %)
- Toggle "Navrhnout do databÃ¡ze" s rate limiting (5/tÃ½den)

**Autocomplete v receptech:**
- KombinovanÃ© hledÃ¡nÃ­ z oblÃ­benÃ½ch + veÅ™ejnÃ© DB
- VarovÃ¡nÃ­ pÅ™i konfliktu typu (vape vs shisha)
- Auto-nastavenÃ­ doporuÄenÃ©ho %

**n8n workflow:** `docs/n8n-flavor-verification-workflow.md`
- AutomatickÃ¡ verifikace nÃ¡vrhÅ¯ AI agentem
- Email notifikace o schvÃ¡lenÃ­/zamÃ­tnutÃ­

**Seed data:**
- 10 testovacÃ­ch pÅ™Ã­chutÃ­: `20260209_seed_test_flavors.sql`
- ProdukÄnÃ­ seed (~100 pÅ™Ã­chutÃ­): `seed_production_flavors.sql`

**API funkce (database.js):**
- `getFlavorManufacturers()`, `searchFlavors()`, `getFlavorById()`
- `addFlavorRating()`, `getUserFlavorRating()`
- `submitFlavorSuggestion()`, `getUserSuggestionCount()`
- `searchFlavorsForAutocomplete()`, `saveFlavorToFavorites()`

**PÅ™eklady:** NovÃ© klÃ­Äe ve vÅ¡ech 31 locale souborech
- `flavor_database.*`, `flavor_suggestion.*`
- `flavor_form.*`, `flavor_autocomplete.*`, `flavor_categories.*`

---

## ğŸ“… DENNÃ ZÃZNAMY

### 08.02.2026 - ZjiÅ¡tÄ›nÃ© problÃ©my

**PÅ™eklady ingredientÅ¯ NEFUNGUJÃ sprÃ¡vnÄ›:**
- `sweetener` zobrazuje anglickÃ½ text mÃ­sto pÅ™eloÅ¾enÃ©ho
- `shortfill_base` zobrazuje technickÃ½ klÃ­Ä
- PÅ™Ã­chutÄ› v litevÅ¡tinÄ› zobrazujÃ­ "Watermelon / Meloun"

**Å˜eÅ¡enÃ­:** Upravit `getIngredientName()`:
```javascript
if (key === 'sweetener') {
    const sweetenerType = ingredient.sweetenerType || 'honey';
    return t(`shisha.sweetener.${sweetenerType}`, sweetenerType);
}
if (key === 'shortfill_base') {
    return t('shortfill.base', 'Shortfill bÃ¡ze');
}
```

### 05.02.2026 - ImplementovÃ¡no

- âœ… SystÃ©m obtÃ­Å¾nosti receptÅ¯ (beginner, intermediate, expert, virtuoso)
- âœ… Filtr obtÃ­Å¾nosti v databÃ¡zi receptÅ¯
- âœ… Oprava hodnocenÃ­ receptÅ¯ (CSS selektory + RLS)
- âœ… Shisha separÃ¡tnÃ­ VG/PG reÅ¾im
- âœ… Seed 35 receptÅ¯ se sprÃ¡vnou strukturou

### 04.02.2026 - ImplementovÃ¡no

- âœ… Sklad produktÅ¯ (stock_quantity v favorite_products)
- âœ… OdstranÄ›nÃ­ duplicitnÃ­ch funkcÃ­ v database.js
- âœ… Oprava `goBackToCalculator()` pro shisha a dilute

---

## Service Worker

- **AktuÃ¡lnÃ­ verze:** `liquimixer-v163`

---

*PoslednÃ­ aktualizace: 2026-02-09*
